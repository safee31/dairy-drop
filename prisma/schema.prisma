generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Role {
  id          String   @id @default(cuid())
  type        Int      @unique
  name        String   @unique @db.VarChar(50)
  description String?  @db.VarChar(500)
  permissions Json     @default("{}")
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  users User[]

  @@index([type])
  @@index([isActive])
  @@map("roles")
}

model User {
  id               String    @id @default(cuid())
  email            String    @unique @db.VarChar(255)
  password         String    @db.VarChar(255)
  fullName         String    @db.VarChar(100)
  profileImage     String?   @db.VarChar(500)
  phoneNumber      String?   @db.VarChar(20)
  isActive         Boolean   @default(true)
  isVerified       Boolean   @default(false)
  lastLoginAt      DateTime?
  roleId           String?
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt

  role      Role?     @relation(fields: [roleId], references: [id], onDelete: SetNull)
  addresses Address[]

  @@index([email])
  @@index([isActive, isVerified])
  @@index([roleId])
  @@map("users")
}

model Address {
  id            String   @id @default(cuid())
  userId        String
  label         String?  @db.VarChar(50)
  fullName      String   @db.VarChar(100)
  phoneNumber   String?  @db.VarChar(20)
  streetAddress String   @db.VarChar(255)
  apartment     String?  @db.VarChar(50)
  city          String   @db.VarChar(100)
  state         String?  @db.VarChar(100)
  postalCode    String   @db.VarChar(20)
  country       String   @db.VarChar(100)
  isPrimary     Boolean  @default(false)
  isActive      Boolean  @default(true)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, isActive])
  @@index([userId, isPrimary])
  @@map("addresses")
}